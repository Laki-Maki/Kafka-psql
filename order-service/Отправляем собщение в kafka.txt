# Путь к файлу JSON
$jsonFile = "D:\temywka_D\VS code_D\Go\WB\order-service\assets\sample_order.json"

# Читаем JSON как массив объектов
$json = Get-Content $jsonFile | ConvertFrom-Json

# Топик Kafka
$topic = "my-new-topic10"

# Отправляем каждый объект в Kafka
$json | ForEach-Object {
    $message = $_ | ConvertTo-Json -Compress
    $message | docker exec -i order-service-kafka-1 /opt/kafka/bin/kafka-console-producer.sh --broker-list localhost:9092 --topic $topic
}

Write-Host "Все сообщения из sample_order.json отправлены в Kafka топик '$topic'."
